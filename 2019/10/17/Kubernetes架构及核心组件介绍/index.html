<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kubernetes架构及核心组件介绍 - 个人日常技术</title>

<link rel="icon" href="https://weiblog.oss-cn-beijing.aliyuncs.com/img/20210221121303.png" />


<!-- CSS -->
<link rel="stylesheet" href="/css/style.css">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Kubernetes架构及核心组件介绍">
<meta property="og:description" content="&lt;p&gt;Kubernets是一个容器编排平台，本文主要介绍其整体架构，以及各个核心组件之间是如何协作完成容器的各项编排工作。&lt;/p&gt;">
<meta property="og:url" content="https://xawei.xyz/2019/10/17/Kubernetes%E6%9E%B6%E6%9E%84%E5%8F%8A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/">
<meta property="og:site_name" content="个人日常技术">

<!-- Canonical -->
<link rel="canonical" href="https://xawei.xyz/2019/10/17/Kubernetes%E6%9E%B6%E6%9E%84%E5%8F%8A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/" 
<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
    <div class="banner" style="--gradient-start: #D4F1F9; --gradient-end: #E1F8DC;">
        <div class="banner-content">
            <!-- Header & Logo -->
<div class="header">
    <div class="header-inner">
        <div class="logo">
            <a href="/" class="title">
                
                    Wei&#39;s Blog
                
            </a>
        </div>
        
        <nav class="menu-container">
            <ul class="menu">
                
                    <li class="menu-item">
                        <a class="menu-link" href="/">
                            
                                <i class="fa-solid fa-house"></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a class="menu-link" href="/categories">
                            
                                <i class="fa-solid fa-folder"></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a class="menu-link" href="/archives">
                            
                                <i class="fa-solid fa-box-archive"></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a class="menu-link" href="/about">
                            
                                <i class="fa-solid fa-user"></i>
                            
                            关于
                        </a>
                    </li>
                
                
                
            </ul>
        </nav>
    </div>
</div> 
        </div>
    </div>
    <div class="background-wrapper"></div>
    <div class="container">
        
        <div class="main-content">
            <article class="post">
    <div class="post-header">
        <h1 class="post-title">Kubernetes架构及核心组件介绍</h1>
        <div class="post-meta">
            <span><i class="fa-regular fa-calendar"></i> 2019-10-17</span>
            
                <span><i class="fa-regular fa-calendar-plus"></i> 2025-05-05</span>
            
            
                <span><i class="fa-regular fa-folder"></i>
                    
                        <a href="/categories/kubernetes/">kubernetes</a>
                        
                    
                </span>
            
            
        </div>
    </div>
    
    <div class="post-content-wrapper">
        <div class="post-content">
            
            <p>Kubernets是一个容器编排平台，本文主要介绍其整体架构，以及各个核心组件之间是如何协作完成容器的各项编排工作。</p>
<span id="more"></span>

<h2 id="Kubernetes的架构及组件基础概念"><a href="#Kubernetes的架构及组件基础概念" class="headerlink" title="Kubernetes的架构及组件基础概念"></a>Kubernetes的架构及组件基础概念</h2><p>当你完成Kubernets部署的时候，你得到的是一个集群，集群包含控制面（control plane）组件（master部分），以及woker节点。用户的业务应用容器以Pod的形式，运行在这些worker节点之前。而master控制面组件，则负责管理集群中运行woker节点以及各个容器Pod。在生产环境中，控制面组件一般以多副本的形式部署在多台不同的机器上，以保证高可用。</p>
<p>下面是Kubernets集群的运行架构及核心组件示意图：</p>
<p><img src="https://weiblog-1252613377.cos.ap-chengdu.myqcloud.com/201912152000007.png"></p>
<p>如图所示，左边的控制面的组件，包括etcd, controller-manager, kube-scheduler等。而worker节点上也运行着kubelet和kube-proxy组件。下面分别简单介绍各组件的主要功能。</p>
<h2 id="控制面组件（Control-Plane-Components）"><a href="#控制面组件（Control-Plane-Components）" class="headerlink" title="控制面组件（Control Plane Components）"></a>控制面组件（Control Plane Components）</h2><p>控制面组件执行集群层面的全局操作（如调度）、探测事件并做出相应动作（如当pod副本数不符合deployment中replicas字段设置的值时，启动或停止pod）等。控制面的组件可以在集群中的任意节点上运行，但是一般为了方便管理，一般这些控制面组件会在特定的节点上运行，称之为master节点，不会运行用户的业务容器，与worker节点区分开来。</p>
<h3 id="kube-apiserver"><a href="#kube-apiserver" class="headerlink" title="kube-apiserver"></a>kube-apiserver</h3><p>kube-apiserver是Kubernetes集群的一个控制面组件，对外暴露了Kubernetes API。kube-apiserver是一个无状态的件，我们可以水平扩展，部署多个副本，让流量均衡地分发到多个kube-apiserver服务上。</p>
<h3 id="etcd"><a href="#etcd" class="headerlink" title="etcd"></a>etcd</h3><p>etcd是Kubernetes的默认的持久化KV存储后端，存储整个Kuberntes集群的各种状态信息。需要注意备份这些信息。</p>
<h3 id="kube-scheduler"><a href="#kube-scheduler" class="headerlink" title="kube-scheduler"></a>kube-scheduler</h3><p>Kube-scheduler通过kube-apiserver持续监听集群中新创建还未分配节点的pod，根据一系列策略算法，选择节点来运行pod。策略算法考虑的因素包括：当前pod和其他pod的resource requirements、软硬件、policy限制、亲和性&#x2F;反亲和性、资源分布性（例如多个pod应该落在多个可用区来增强可用性）等。</p>
<p>需要注意的是，kube-scheduler是为pod分配节点，在pod资源上进行标记，而未实际把pod启动起来，因为那是kubelet的工作，后面会介绍到。</p>
<h3 id="kube-controller-manager"><a href="#kube-controller-manager" class="headerlink" title="kube-controller-manager"></a>kube-controller-manager</h3><p>kube-controller-manager是Kubernets中各种内置controller控制器的合集，在逻辑上，每个controller都是独立运行工作的，而实际上为了降低复杂性，这些controller都被编译到一个二进制中，启动一个进程来运行这些controller。一些典型的controller包括：</p>
<ul>
<li>Node controller：监测节点的宕机情况，并做出响应（如驱逐宕机节点上的pod）；</li>
<li>Service controller：为每个新的namespace创建默认的ServiceAccounts</li>
</ul>
<h3 id="cloud-controller-manager"><a href="#cloud-controller-manager" class="headerlink" title="cloud-controller-manager"></a>cloud-controller-manager</h3><p>我们可以在Kubernetes中添加特定云服务的控制逻辑。这些cloud controller与Kubernets中只与内部交互的controller不同，会与云厂商的API进行交互，管理云基础设置。</p>
<h2 id="Worker节点上的组件"><a href="#Worker节点上的组件" class="headerlink" title="Worker节点上的组件"></a>Worker节点上的组件</h2><p>kubelet和kube-proxy运行在每个节点上，负责维护运行的pod和Kubernetes的运行时环境。</p>
<h3 id="kubelet"><a href="#kubelet" class="headerlink" title="kubelet"></a>kubelet</h3><p>kueblet是一个运行在节点上的agent，通过kube-apiserver监听分配到该节点上的pod，然后根据pod的定义，调用容器运行时，确保pod的容器业务运行起来。（当然还有特殊的static pod了，可以参考：<a href="http://xawei.xyz/2021/06/22/Kubernetes%E4%B8%AD%E7%9A%84static%20pod%E5%AE%9E%E7%8E%B0%E4%B8%8E%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90/">Kubernetes中的Static pod实现与使用场景分析</a>）</p>
<h3 id="kube-proxy"><a href="#kube-proxy" class="headerlink" title="kube-proxy"></a>kube-proxy</h3><p>Kube-proxy是每个节点上都运行的network proxy，负责实现Kubernetes中的Service的概念。Kube-proxy维护节点上的网络路由规则，让集群上同节点或不同节点的pod可以通信。</p>
<p>如果操作系统支持包过滤层（packet filtering layer），那么kube-proxy会使用这一方式实现它的功能，否则kube-proxy会自己来进行流量转发。</p>
<h3 id="Container-runtime"><a href="#Container-runtime" class="headerlink" title="Container runtime"></a>Container runtime</h3><p>容器运行时是负责实际运行容器的组件，如containerd、CRI-O等，任意使用了<a target="_blank" rel="noopener" href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/container-runtime-interface.md">Kuberntes CRI协议</a>的服务都可以作为Kuberntes的容器运行时。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/overview/components/">Kubernetes Docs - Kubernetes Components</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/">Kubernetes Docs - Control Plane-Node Communication</a></li>
</ol>

        </div>
        
        
            <div class="post-copyright">
                <div class="copyright-title">版权声明</div>
                <div class="copyright-info">
                    <div class="copyright-info-item">
                        <span>作者:</span>
                        <span>xawei</span>
                    </div>
                    <div class="copyright-info-item">
                        <span>链接:</span>
                        <a href="https://xawei.xyz/2019/10/17/Kubernetes%E6%9E%B6%E6%9E%84%E5%8F%8A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/">https://xawei.xyz/2019/10/17/Kubernetes%E6%9E%B6%E6%9E%84%E5%8F%8A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/</a>
                    </div>
                    <div class="copyright-info-item">
                        <span>本博客所有文章除特别声明外，均采用 CC BY-NC-SA 4.0 许可协议。</span>
                    </div>
                </div>
            </div>
        
        
        <div class="post-navigation">
            <div class="post-nav-prev">
                
                    <a href="/2020/12/13/%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5/" class="post-nav-link">
                        <i class="fa-solid fa-angle-left"></i>
                        <span class="post-nav-title">几种常见的发布策略</span>
                    </a>
                
            </div>
            <div class="post-nav-next">
                
            </div>
        </div>
    </div>
</article>


    <div class="toc-container">
        <div class="toc-sticky">
            <div class="toc-header">
                <div class="toc-title"><i class="fa-solid fa-list-ul"></i> <span>目录</span></div>
                <button class="toc-toggle" aria-label="Toggle Table of Contents">
                    <i class="fa-solid fa-angle-left"></i>
                </button>
            </div>
            <div class="toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kubernetes%E7%9A%84%E6%9E%B6%E6%9E%84%E5%8F%8A%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-text">Kubernetes的架构及组件基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E9%9D%A2%E7%BB%84%E4%BB%B6%EF%BC%88Control-Plane-Components%EF%BC%89"><span class="toc-text">控制面组件（Control Plane Components）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#kube-apiserver"><span class="toc-text">kube-apiserver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#etcd"><span class="toc-text">etcd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kube-scheduler"><span class="toc-text">kube-scheduler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kube-controller-manager"><span class="toc-text">kube-controller-manager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cloud-controller-manager"><span class="toc-text">cloud-controller-manager</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Worker%E8%8A%82%E7%82%B9%E4%B8%8A%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-text">Worker节点上的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#kubelet"><span class="toc-text">kubelet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kube-proxy"><span class="toc-text">kube-proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Container-runtime"><span class="toc-text">Container runtime</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol>
            </div>
            <div class="toc-progress">
                <div class="toc-progress-bar"></div>
            </div>
        </div>
    </div>
 
        </div>
        
    </div>
    <!-- Footer -->
<footer class="footer">
    <div class="footer-inner">
        <div class="copyright">
            © 2025 <i class="fa-solid fa-heart"></i> xawei
        </div>
    </div>
</footer> 
    <div class="back-to-top">
        <i class="fa-solid fa-arrow-up"></i>
    </div>
    <!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>

<!-- Theme scripts -->
<script src="/js/main.js"></script>


<!-- TOC functionality -->
<script src="/js/toc.js"></script>
 
</body>
</html> 